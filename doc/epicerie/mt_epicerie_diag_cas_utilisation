@startuml

' VOIR https://plantuml.com/fr/use-case-diagram

' VOIR https://plantuml.com/fr/commons


left to right direction
skinparam packageStyle rectangle


title <u>Épicerie Graine2Vie MT31 - Cas d'Utilisation</u>


' ---------------
' LÉGENDE
' ---------------

'On pouvait aussi utiliser _note_ au lieu de _legend_ mais ca se met tout en haut:'
'(cf note dans http://plantuml.com/fr/class-diagram)'
'note as N1'

skinparam legendFontSize 11
legend top left

Diagramme UML de Cas d'Utilisation du 27/11/2020 - Etienne Pallier (généré avec PlantUML - http://plantuml.com)

__Notes__ :
- UC = "Cas d'Utilisation" ("Use Case" en anglais)
- Tous ces UCs sont soumis à une première étape d'authentification (login). Ils impliquent aussi systèmatiquement un accès à la BD (lecture ou/et écriture).
- UC1 (Administration de la BD par l'Administrateur) est sous-entendu car il ne demande pas de développement vu qu'on utilisera des outils existants (tels que PhpMyAdmin ou MysqlWorkBench)
- UC6 ne nécessite a priori pas de formulaire, mais juste un bouton qui va déclencher la création du rapport (format Excel/CSV)
- UC7 ne nécessite qu'un écran où on affiche quelques infos utiles pour remplir à la main le rapport pour la FEP (format papier) 
- UC3 est un sous ensemble de UC2, et nécessite 2 formulaires ; il permettra d'afficher une liste de bénéficiaires selon différents critères (à définir), et d'aller à la vue détaillée d'un bénéficiare en cliquant sur son nom  
'- UC4 nécessite juste un petit formulaire tout simple de mise à jour d'une liste de vendeurs (nom, prénom, email, tel, dates début et fin de service)
- //Inutile de créer un UC pour l'impression d'une liste papier des bénéficiaires autorisés pour une permanence donnée si on équipe l'Accueil et les Vendeurs de tablettes en wifi//
	\t//(la caissière équipée d'un PC fixe aura accès au quasi-même formulaire que celui des vendeurs, le prix total à payer étant déjà calculé, au fur et à mesure)// 
- UC2 et UC5 sont les 2 seuls gros UCs qui ont vraiment besoin de formulaires (et assez complexes) :
	\t- UC2 (Gestion bénéficiaires) ne nécessite qu'1 seul gros formulaire permettant de d'ajouter ou modifier un bénéficiaire
	\t- UC5 (Achat) est plus complexe et nécessite 3 formulaires :
		\t\t- F5.1 - liste des Bénéficiaires autorisés pour la permanence, avec pour chacun : son créneau horaire, son type de transaction (colis/achat), sa dette éventuelle, une case à cocher "présent",
		\t\t\t (dans cette liste, les bénéficiaires en cours d'achat sont surlignés, avec nom du vendeur associé ; en cliquant sur un bénéficiaire on arrive au formulaire suivant, le F5.2) 
		\t\t- F5.2 - le "bénéficiaire en épicerie, vue détaillée" : on y affiche les infos essentielles sur le bénéficiaire, sa dette éventuelle, le prénom du vendeur choisi, la liste des achats (+ prix colis)...
		\t\t\t(avec calcul automatique du prix total à payer + prix colis)
		\t\t- F5.3 - le "bénéficiaire en épicerie, vue de synthèse" : on y affiche les infos essentielles sur le bénéficiaire, le vendeur, la dette éventuelle, le total des achats (+ colis) à payer
		\t\t\t(avec calcul automatique du prix total à payer + prix colis)
		\t\t- Scénario :
			\t\t\t1) Un Bénéficiaire se présente
			\t\t\t2) Il est pris en charge par le Responsable Accueil qui (à l'aide de F5.1 et F5.2) vérifie son autorisation, coche sa présence, et lui affecte un vendeur (en tapant son prénom)
			\t\t\t3) Le Vendeur choisi donne un colis au Bénéficiaire ou bien fait les achats avec lui et note le poids des articles pris (à l'aide du formulaire F5.2)
			\t\t\t4) La Caissière accède à la vue de synthèse du Bénéficiaire (F5.3) à partir du formulaire F5.1, puis procède à l'encaissement (ou enregistre la dette)

end legend
'end note'


' ------------------
' Définition ACTEURS
' ------------------

'actor "Assistante Sociale" as AS

'actor Administrateur as A

' Jackye S. et Serge
actor "Responsable \nBénéficiaires \n(1-2)" as RB 

' Véronique
'actor "Conseiller Insert. Soc. et Prof." as CISP
'actor "CISP" as CISP
' qui ?
'actor "Commission \nhebdo (3-4)" as CH
actor "Commission \nhebdo (3-4) \n+CISP" as CH_CISP

' CA ?

' Claude
actor "Gestionnaire \nStock" as GS

' Christian S. et Michel M.
actor "Trésorier \nou Président" as TP
'actor "Président" as P
'actor "Trésorier" as T

' Michel
actor "Préparateur (3-4)" as P
actor "Client (Bénéficiaire) \n(env. 300/an) \n(30/permanence) \n(12 max/créneau)" as B
actor "Accueil" as RA
actor "Vendeur (3-4)" as VE
actor "Caissier" as Caissier

actor "Banque \nAlimentaire" as BA
'actor "Fédération Entraide Protestante" as FEP
actor FEP



rectangle "Système Épicerie Graine2Vie MT31" {


' --------------------
' Définition USE CASES
' --------------------

'usecase UC1_ABD as "UC1 - Administration Base de Données"

'usecase "UC4 - Mise à jour liste Vendeurs" as UC4_GV

usecase UC2_GB as "UC2 - Gestion Bénéficiaires (ajout et mise à jour)
	..
	(composition famille, contrats, suivi activité)
'	(composition famille, critères revenus, charges, contrats, suivi activité)
"
	
usecase "UC3 - Consultation Bénéficiaires \n(selon différents critères)" as UC3_CB


'usecase UC4a_ELB as "UC4 --Edition liste bénéficiaires autorisés-- (plus nécessaire ?)
'	(QUAND : jour de permanence - mardi1-2 ou vendredi1-2)
'	..
'	(/type-transaction (achat ou colis) puis /créneau)
'" 

'usecase UC4_CLB as "CONSULTATION 'liste bénéficiaires autorisés' et MISE-A-JOUR suivi activité
'	(QUAND : jour de permanence)
'	..
'	(présence des pers., paiement ou dette, poids produits /catégorie)
'" 
  
usecase UC5_AE as "UC5 - ACHAT à l'épicerie (ou récupération colis alimentaire)
	..
	(QUAND: jour de permanence, /15 jours, mardi1-2 ou vendredi1-2, 14-17h)
	(3 créneaux 1h prédéfinis, pendant 3-6 mois)
	..
	présence/absence des pers., 
	colis (poids produits/catégorie lait,frais,sec, et prix),
	achats (liste articles achetés et prix),
	calcul prix total à payer, paiement ou dette
" 

usecase UC6_RABA as "UC6 - Création auto Rapport Activité trim. pour Banque Alimentaire
	(QUAND: /trimestre et /an, avant T+1mois)
	..
	(séparer colis et achats)
	nb foyers et pers. inscrites, nb visites épicerie,
	poids total distribué, poids reçu de BA sur période
"

usecase UC7_RAH as "UC7 - Affichage infos pour Rapports Activité annuels (FEP et BA) (habilitation nationale)
	(QUAND: /an, avant fin février)
	..
	nb foyers et pers. inscrites,
	qté denrées distribuées (total, % BA, % ressources propres),
	typologie pers. (nb F/H, nb par tranche âge),
	nb aides alimentaires
"



' ---------------
' DIAGRAMME
' ---------------

'A -- (UC1_ABD)

RB -- (UC2_GB)
'CISP -- (UC2_GB) 
'CH -- (UC2_GB)

'RB -- (UC4_GV)
  
RB -- (UC3_CB)
TP -- (UC3_CB)
CH_CISP -- (UC3_CB) 
'CH -- (UC3_CB)

'RA -- (UC4_CLB)
    
P -- (UC5_AE) : préparation colis (la veille) \net saisie composition \n(sec/lait/frais) 
B -- (UC5_AE) : Achat
RA -- (UC5_AE) : autorisation, suivi activité, \naffect. Vendeur-Client
VE -- (UC5_AE) : aide, conseil, \nenregistrement achats
Caissier -- (UC5_AE) : encaissement \n(+ saisie dette)


RB -- (UC6_RABA)
TP -- (UC6_RABA)
(UC6_RABA) -- BA : feuille Excel (3 ongl.) CSV \n(selon format BA)
GS -- (UC6_RABA) : poids denrées \ndistribuées

GS -- (UC7_RAH) : poids denrées \ndistribuées
RB -- (UC7_RAH)
TP -- (UC7_RAH)
(UC7_RAH)  -- FEP : document papier rempli à la main \n(format imposé par FEP) 
(UC7_RAH)  -- BA : document papier rempli à la main



}



@enduml
